<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDS 量表自测</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
        }

        h1 {
            font-size: 24px;
            color: #4CAF50;
            margin-bottom: 20px;
            text-align: center;
        }

        .instructions {
            font-size: 14px;
            line-height: 1.6;
            color: #666;
            margin-bottom: 30px;
        }

        .question {
            margin-bottom: 20px;
            font-size: 14px;
            color: #444;
        }

        .score-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .score-buttons button {
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            border-radius: 6px;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .score-buttons button:hover {
            background-color: #e9e9e9;
            transform: translateY(-2px);
        }

        .score-buttons button.selected {
            background-color: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .submit-button {
            display: block;
            width: 100%;
            padding: 12px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            transition: background-color 0.3s ease;
            margin-top: 30px;
        }

        .submit-button:hover {
            background-color: #45a049;
        }

        .name-input {
            margin-bottom: 20px;
        }

        .name-input label {
            font-size: 14px;
            color: #666;
        }

        .name-input input {
            width: 100%;
            padding: 8px;
            font-size: 14px;
            border: 1px solid #ddd;
            border-radius: 6px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SDS 量表自测</h1>
        <div class="instructions">
            <p>下面有20条文字，请仔细阅读每一条，把意思弄明白，然后根据您最近一星期的实际情况，在适当的方格里画一勾(√)。</p>
            <p>每一条文字后有4个方格，分别代表没有或很少时间，少部分时间，相当多时间或全部时间。</p>
        </div>

        <div class="name-input">
            <label for="name">请输入姓名:</label>
            <input type="text" id="name" name="name" placeholder="请输入您的姓名">
        </div>

        <div id="questions">
            <!-- 问题将在这里动态生成 -->
        </div>

        <button class="submit-button" onclick="submitTest()">提交</button>
    </div>

    <script>
        const questions = [
            "1. 我觉得闷闷不乐，情绪低沉（忧郁）。",
            "2. 我觉得一天中早晨最好（晨重晚轻）。",
            "3. 我一阵阵哭出来或觉得想哭（易哭）。",
            "4．我晚上睡眠不好(睡眠障碍)。",
            "5．我吃得跟平常一样多(食欲减退)。",
            "6.我与异性密切接触时和以往一样感到愉快(性兴趣减退)。",
            "7.我发觉我的体重在下降(体重减轻)。",
            "8.我有便秘的苦恼(便秘)。",
            "9．我心跳比平常快(心悸)。",
            "10.我无缘无故地感到疲乏(易倦)。",
            "11.我的头脑跟平常-一样清楚(思考困难)。",
            "12．我觉得做经常做的事并没有困难(能力减退)。",
            "13．我觉得不安而平静不下来(不安)。",
            "14，我对将来抱有希望(绝望)。",
            "15．我比平常容易生气激动(易激惹)。",
            "16.我觉得做出决定是容易的(决断困难)。",
            "17．我觉得自己是个有用的人,有人需要我(无用感)。",
            "18.我的生活过得很有意思(生活空虚感)。",
            "19．我认为如果我死了,别人会过得好些(无价值感)。",
            "20.平常感兴趣的事我仍然感兴趣(兴趣丧失)。",
        ];

        const reverseQuestions = [1, 4, 5, 10, 11, 13, 15, 16, 17, 19]; // 反向评分题的索引（从0开始）
        const scores = new Array(questions.length).fill(null);

        function generateQuestions() {
            const container = document.getElementById('questions');
            questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.textContent = question;

                const buttonsDiv = document.createElement('div');
                buttonsDiv.className = 'score-buttons';

                for (let score = 1; score <= 4; score++) {
                    const button = document.createElement('button');
                    button.textContent = score;
                    button.onclick = () => setScore(index, score);
                    buttonsDiv.appendChild(button);
                }

                questionDiv.appendChild(buttonsDiv);
                container.appendChild(questionDiv);
            });
        }

        function setScore(questionIndex, score) {
            const buttons = document.querySelectorAll(`#questions .question:nth-child(${questionIndex + 1}) .score-buttons button`);
            buttons.forEach((button, index) => {
                if (index + 1 === score) {
                    button.classList.add('selected');
                } else {
                    button.classList.remove('selected');
                }
            });
            scores[questionIndex] = score;
        }

        function submitTest() {
            const name = document.getElementById('name').value.trim();
            if (!name) {
                alert('请输入您的姓名');
                return;
            }

            if (scores.includes(null)) {
                alert('请完成所有问题的评分');
                return;
            }

            let totalScore = 0;
            scores.forEach((score, index) => {
                if (reverseQuestions.includes(index)) {
                    totalScore += 4 - score;
                } else {
                    totalScore += score;
                }
            });

            alert(`您的总分是: ${totalScore}`);
            saveResult(name, totalScore);
        }

        function saveResult(name, totalScore) {
            const data = `姓名,score\n${name},${totalScore}`;
            const blob = new Blob([data], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${name}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // 页面加载时生成问题
        window.onload = generateQuestions;
    </script>
</body>
</html>